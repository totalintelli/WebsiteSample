<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
    <style>
      .google-visualization-table-td {
        color: blue !important;
        text-align: center;
      }
    </style>
  </head>

  <body>
    <table></table>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script
      type="text/javascript"
      src="https://www.gstatic.com/charts/loader.js"
    ></script>
    <div>
      <button id="export" class="ui-button ui-widget ui-corner-all">
        <span class="ui-icon ui-icon-circle-triangle-s"></span
        ><span>&nbsp;Download CSV</span>
      </button>
    </div>
    <div id="table_div"></div>
    <script type="text/javascript">
      google.charts.load("current", { packages: ["table"] });

      function draw() {
        drawDayTable();
      }

      function formatDate(date) {
        var d = new Date(date),
          month = "" + (d.getMonth() + 1),
          day = "" + d.getDate(),
          year = d.getFullYear();

        if (month.length < 2) month = "0" + month;
        if (day.length < 2) day = "0" + day;

        return [year, month, day].join("-");
      }

      const today = formatDate(new Date());
      const dataset = [
        [
          1,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          2,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          3,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          4,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          5,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          6,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          7,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          8,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          9,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          10,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          11,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          12,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          13,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          14,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          15,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          16,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          null,
          null,
          "누계/합계",
          100000.1,
          100000,
          100000,
          100000,
          100000,
          100000,
          100000,
          100000,
          100000,
          100000,
          100000
        ],
        [
          17,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          18,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          19,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          20,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ],
        [
          21,
          today,
          "5:00",
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0,
          130.0
        ]
      ];

      //   var cssClassNames = {
      //     headerRow: "cssHeaderRow",
      //     tableRow: "cssTableRow",
      //     oddTableRow: "cssOddTableRow",
      //     selectedTableRow: "cssSelectedTableRow",
      //     hoverTableRow: "cssHoverTableRow",
      //     headerCell: "cssHeaderCell",
      //     tableCell: "cssTableCell",
      //     rowNumberCell: "cssRowNumberCell",
      //     gradient: "cssHeaderCell"
      //   };

      function drawDayTable() {
        var data = new google.visualization.DataTable();
        data.addColumn("number", "구분");
        data.addColumn("string", "일자");
        data.addColumn("string", "시간");
        data.addColumn("number", "INV-1(kWh)");
        data.addColumn("number", "INV-2(kWh)");
        data.addColumn("number", "INV-3(kWh)");
        data.addColumn("number", "INV-4(kWh)");
        data.addColumn("number", "INV-5(kWh)");
        data.addColumn("number", "전체 발전량(kWh)");
        data.addColumn("number", "발전시간(h)");
        data.addColumn("number", "경사일사량(W/㎡)");
        data.addColumn("number", "수평일사량(W/㎡)");
        data.addColumn("number", "모듈온도(℃)");
        data.addColumn("number", "대기온도(℃)");
        data.addRows(dataset);

        var table = new google.visualization.Table(
          document.getElementById("table_div")
        );

        table.draw(data, {
          width: "100%",
          height: "100%",
          page: "enable",
          pageSize: 17,
          pagingSymbols: {
            prev: "prev",
            next: "next"
          },
          pagingButtonsConfiguration: "auto"
          //   cssClassNames: cssClassNames
        });

        return data;
      }

      $("#export").on("click", function() {
        var browserIsIE;
        var csvColumns;
        var csvContent;
        var downloadLink;
        var fileName;
        var tableData = drawDayTable();
        // build column headings
        csvColumns = "";
        for (var i = 0; i < tableData.getNumberOfColumns(); i++) {
          csvColumns += tableData.getColumnLabel(i);
          if (i < tableData.getNumberOfColumns() - 1) {
            csvColumns += ",";
          }
        }
        csvColumns += "\n";

        // build data rows
        csvContent =
          csvColumns + google.visualization.dataTableToCsv(tableData);

        // download file
        browserIsIE = false || !!document.documentMode;
        fileName = "data.csv";
        if (browserIsIE) {
          window.navigator.msSaveBlob(
            new Blob([csvContent], { type: "data:text/csv" }),
            fileName
          );
        } else {
          downloadLink = document.createElement("a");
          downloadLink.href =
            "data:application/csv;charset=utf-8,\uFEFF" + encodeURI(csvContent);
          downloadLink.download = fileName;
          raiseEvent(downloadLink, "click");
          downloadLink = null;
        }
      });

      function raiseEvent(element, eventType) {
        var eventRaised;
        if (document.createEvent) {
          eventRaised = document.createEvent("MouseEvents");
          eventRaised.initEvent(eventType, true, false);
          element.dispatchEvent(eventRaised);
        } else if (document.createEventObject) {
          eventRaised = document.createEventObject();
          element.fireEvent("on" + eventType, eventRaised);
        }
      }

      google.charts.setOnLoadCallback(draw);
    </script>
  </body>
</html>
